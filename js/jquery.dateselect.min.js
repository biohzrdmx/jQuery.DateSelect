/**
* jQuery DateSelect
* @author biohzrdmx <github.com/biohzrdmx>
* @version 1.0
* @requires jQuery 1.8+
* @license MIT
*/
;!function(i){i.dateSelect={templates:{selector:'<div class="date-select"><div class="date-select popup"><span class="tip"></span><div class="select day"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">01</span><span class="text">Thursday</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="select month"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">01</span><span class="text">September</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="select year"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">2014</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="buttons"><a href="#" class="btn-cancel"><i class="fa fa-times"></i></a><a href="#" class="btn-ok"><i class="fa fa-check"></i></a></div></div></div>'},defaults:{formatDate:function(e){return i.dateSelect.pad(e.getDate(),2)+"/"+i.dateSelect.pad(e.getMonth()+1,2)+"/"+e.getFullYear()},parseDate:function(e){var t=new Date,n=e.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);return n&&4==n.length&&(t=new Date(n[3],n[2]-1,n[1])),t},callbacks:{onShow:function(e){},onHide:function(e){}},container:"body",element:null,date:(new Date).toDateString(),strings:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]}},pad:function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},update:function(e,t,n){var a=e.find(".day"),c=e.find(".month"),l=e.find(".year"),i=a.find(".num"),s=c.find(".num"),o=l.find(".num"),d=a.find(".text"),r=c.find(".text"),u=t.getDate(),f=t.getDay(),p=t.getMonth(),h=t.getFullYear();i.text(u),s.text(p+1),o.text(h),d.text(n.strings.days[f]),r.text(n.strings.months[p])},show:function(e){var n=this,a=i.extend(!0,{},i.dateSelect.defaults,e),t=i(n.templates.selector),c=new Date(a.date);if(n.hide(!0),a.element&&("string"==typeof a.element&&(a.element=i(a.element)),c=a.parseDate(a.element.val())),n.update(t,c,a),t.on("click",".day .btn-up",function(e){c.setDate(c.getDate()+1),n.update(t,c,a),e.preventDefault()}),t.on("click",".day .btn-down",function(e){c.setDate(c.getDate()-1),n.update(t,c,a),e.preventDefault()}),t.on("click",".month .btn-up",function(e){c.setMonth(c.getMonth()+1),n.update(t,c,a),e.preventDefault()}),t.on("click",".month .btn-down",function(e){c.setMonth(c.getMonth()-1),n.update(t,c,a),e.preventDefault()}),t.on("click",".year .btn-up",function(e){c.setFullYear(c.getFullYear()+1),n.update(t,c,a),e.preventDefault()}),t.on("click",".year .btn-down",function(e){c.setFullYear(c.getFullYear()-1),n.update(t,c,a),e.preventDefault()}),t.on("click",".btn-ok",function(e){e.preventDefault();var t=a.formatDate(c);i(a.element).val(t),i(a.element).trigger("change"),n.hide()}),t.on("click",".btn-cancel",function(e){e.preventDefault(),n.hide()}),t.on("mousewheel",".day",function(e){0<e.deltaY?i(".day .btn-up").trigger("click"):e.deltaY<0&&i(".day .btn-down").trigger("click")}),t.on("mousewheel",".month",function(e){0<e.deltaY?i(".month .btn-up").trigger("click"):e.deltaY<0&&i(".month .btn-down").trigger("click")}),t.on("mousewheel",".year",function(e){0<e.deltaY?i(".year .btn-up").trigger("click"):e.deltaY<0&&i(".year .btn-down").trigger("click")}),t.hide(),i(a.container).append(t),a.element){var l=a.element.offset();t.css({left:l.left+"px",top:l.top+a.element.outerHeight(!0)+15+"px"})}t.data("opts",a),t.fadeIn(150,function(){a.callbacks.onShow(t)})},hide:function(e){e=e||!1;var t=i(".date-select"),n=t.data("opts");t.length&&(e?(n.callbacks.onHide(t),t.remove()):t.fadeOut(150,function(){n.callbacks.onHide(t),t.remove()}))}},i.fn.dateSelect=function(e){if(!this.length)return this;i.extend(!0,{},i.dateSelect.defaults,e);return this.each(function(){var t=i(this),e=t.parent();t.on("click",function(){i.dateSelect.show({element:t})}),e.find("[data-toggle=select]").on("click",function(e){e.preventDefault(),i(".date-select:visible").length?i.dateSelect.hide():i.dateSelect.show({element:t})})}),this},i("[data-select=date]").each(function(){i(this).dateSelect()})}(jQuery);
